ğŸŒ Projeto de Processamento e ConsolidaÃ§Ã£o de Dados de IoT

ğŸ—‹ DescriÃ§Ã£o

Este projeto visa resumir e consolidar os dados de trÃ¡fego de IoT gerados por dispositivos distribuÃ­dos geograficamente em uma infraestrutura AWS escalÃ¡vel. Ele utiliza buckets S3, funÃ§Ãµes Lambda, instÃ¢ncias EC2 e filas SQS para processar e analisar dados com eficiÃªncia e resiliÃªncia.

ğŸ¢ Arquitetura

ğŸ‘¤ Client Application: Faz o upload de arquivos CSV para o bucket S3 mybucket0000000000/input.

ğŸ”„ Lambda Worker: Processa arquivos CSV e gera resumos diÃ¡rios, armazenando-os em mybucket0000000000/summaries.

ğŸ’» EC2 Worker (Consolidator): Consolida os resumos, calculando mÃ©tricas estatÃ­sticas e salvando os resultados consolidados em mybucket1111111111111/consolidated.

ğŸ“Š Export Client: Combina os dados consolidados e gera um arquivo CSV final disponÃ­vel para download.

Fluxo de Dados

[Dispositivos IoT] â†’ [Client Application] â†’ [S3 Bucket mybucket0000000000/input]

[S3 Bucket] â†’ [SQS Queue] â†’ [Lambda Worker]

[Lambda Worker] â†’ [S3 Bucket mybucket0000000000/summaries]

[S3 Bucket] â†’ [EC2 Worker]

[EC2 Worker] â†’ [S3 Bucket mybucket1111111111111/consolidated]

[S3 Bucket] â†’ [Export Client] â†’ [CSV Final]

Justificativa dos Componentes AWS

S3: Armazenamento confiÃ¡vel e escalÃ¡vel para arquivos CSV.

SQS: Garantia de processamento resiliente e desacoplamento entre componentes.

Lambda: Processamento eficiente e escalabilidade automÃ¡tica.

EC2: Controle granular para consolidaÃ§Ã£o de dados com altos volumes e cÃ¡lculos intensivos.

ğŸš€ ConfiguraÃ§Ã£o e ExecuÃ§Ã£o

ConfiguraÃ§Ã£o Inicial

Buckets S3:

Crie os seguintes buckets e pastas dentro deles:

mybucket0000000000/input: Para armazenar arquivos CSV brutos enviados pelas filiais.

mybucket0000000000/summaries: Para armazenar os resumos gerados pelo Lambda Worker.

mybucket1111111111111/consolidated: Para armazenar os dados consolidados pelo EC2 Worker.

Lambda Worker:

Crie uma funÃ§Ã£o Lambda que seja acionada sempre que novos arquivos forem adicionados ao bucket mybucket0000000000/input.

Certifique-se de que a funÃ§Ã£o possui permissÃµes para ler do bucket de entrada e gravar no bucket de resumos.

InstÃ¢ncia EC2:

Configure uma instÃ¢ncia EC2 com permissÃµes para acessar os buckets S3 e a fila SQS.

FaÃ§a o upload do Consolidator Worker (arquivo .jar gerado pelo Maven) para a instÃ¢ncia.

Configure o Consolidator Worker para iniciar automaticamente ao ligar a instÃ¢ncia. Para isso, utilize o systemd ou o script /etc/rc.local.

SQS Queue:

Crie uma fila no SQS para gerenciar mensagens de processamento entre o Lambda Worker e o EC2 Worker.

Atualize o cÃ³digo do EC2 Worker para usar o URL da fila SQS criada.

Credenciais AWS:

Atualize as credenciais AWS na IDE Java para desenvolvimento local.

Adicione as credenciais na instÃ¢ncia EC2 (use o arquivo ~/.aws/credentials).

ExecuÃ§Ã£o Regular

Upload de Arquivos:

Use o Client Application para enviar arquivos CSV para mybucket0000000000/input. A aplicaÃ§Ã£o solicita o nome e o caminho do arquivo.

Monitoramento:

Acompanhe os logs da execuÃ§Ã£o do Lambda Worker no CloudWatch para verificar o processamento de novos arquivos.

ConsolidaÃ§Ã£o de Dados:

A instÃ¢ncia EC2 monitora a fila SQS. Quando novas mensagens sÃ£o recebidas, o Consolidator Worker processa os arquivos resumidos e grava os resultados no bucket mybucket1111111111111/consolidated.

ExportaÃ§Ã£o de Dados:

Execute o Export Client para combinar os dados consolidados em um Ãºnico arquivo CSV. O arquivo final serÃ¡ salvo em mybucket1111111111111.

ValidaÃ§Ã£o:

Verifique se os arquivos gerados no bucket de consolidaÃ§Ã£o e o CSV final estÃ£o corretos e completos.

ğŸ”„ Componentes e FunÃ§Ãµes

ğŸ“¥ Client Application

FunÃ§Ã£o: Faz upload de arquivos CSV para mybucket0000000000/input.

ConfiguraÃ§Ã£o: Arquivo e caminho definidos pelo usuÃ¡rio ou valores padrÃ£o.

ğŸ”§ Lambda Worker

FunÃ§Ã£o: Processa arquivos CSV e gera resumos diÃ¡rios.

SaÃ­da: Resumos armazenados em mybucket0000000000/summaries.

ğŸ’» EC2 Worker (Consolidator)

Comando: java -jar Consolidator-1.0-SNAPSHOT.jar

FunÃ§Ã£o: Consolida resumos e calcula mÃ©tricas (mÃ©dia e desvio padrÃ£o).

SaÃ­da: Resultados armazenados em mybucket1111111111111/consolidated.

ğŸ“Š Export Client

FunÃ§Ã£o: Gera um arquivo CSV com todos os dados consolidados.

SaÃ­da: Arquivo final armazenado em mybucket1111111111111.

ğŸ¯ Resultados

Desempenho

Lambda: Processa cada arquivo individualmente com escalabilidade automÃ¡tica.

EC2: Processa arquivos em lote para consolidaÃ§Ã£o intensiva de dados.

Tempo Total de ExecuÃ§Ã£o

Lambda: 34.435 segundos.

EC2: 344.358 segundos.

ConclusÃ£o

Utilize Lambda para processamento rÃ¡pido e tarefas paralelas.

Utilize EC2 para consolidaÃ§Ã£o intensiva de dados e controle granular.

ğŸ”§ Ferramentas Utilizadas

AWS S3: Armazenamento escalÃ¡vel.

AWS Lambda: Processamento serverless.

AWS EC2: ConsolidaÃ§Ã£o personalizada.

AWS SQS: Gerenciamento de mensagens.

Java: Linguagem principal.

Maven: Gerenciamento de dependÃªncias e build.

ğŸ› ï¸ RecomendaÃ§Ãµes

Monitoramento: Use o CloudWatch para logs e alertas.

OtimizaÃ§Ã£o: Exclua arquivos intermediÃ¡rios para reduzir custos de armazenamento.

AutomatizaÃ§Ã£o: Considere configurar gatilhos para automatizar o Export Client.